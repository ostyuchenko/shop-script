{$_show_cart = true}
{$_cart_count = $wa->shop->cart->count()}

{* todo: get order details *}
{$_order_id = $wa->get("order_id")}

<style>#header-container { display: none; }</style>

<style>
    .s-cart-success-wrapper,
    .s-cart-empty-wrapper {
        margin: 100px 0;
        text-align: center;
    }
    .s-cart-success-wrapper .s-image-wrapper,
    .s-cart-empty-wrapper .s-image-wrapper {
        margin: 0 0 20px;
    }
    .s-cart-success-wrapper .s-image-wrapper img,
    .s-cart-empty-wrapper .s-image-wrapper img {
        vertical-align: top;
        width: 100%;
        max-height: 160px;
    }
    .s-cart-success-wrapper .s-header,
    .s-cart-empty-wrapper .s-header {
        margin: 0;
        font-size: 36px;
        line-height: 1.472222222222222em;
        font-weight: bold;
        color: #000;
    }
    .s-cart-success-wrapper .s-description,
    .s-cart-empty-wrapper .s-description {
        margin: 20px 0 0;
    }
    .s-cart-success-wrapper .s-plugin-wrapper,
    .s-cart-empty-wrapper .s-plugin-wrapper {
        margin: 30px 0 0;
    }
    .s-cart-success-wrapper .s-payment-success,
    .s-cart-empty-wrapper .s-payment-success {
        margin: 30px 0 0;
    }
    .s-cart-success-wrapper .s-actions-wrapper,
    .s-cart-empty-wrapper .s-actions-wrapper {
        margin: 30px 0 0;
        color: #006bd8;
    }
</style>

{*SUCCESS*}
{if !empty($_order_id)}
    <div class="s-cart-success-wrapper">
        <div class="s-image-wrapper">
            <img src="{$wa_theme_url}img/svg/order/cart_success.svg" alt="[`Your shopping cart is empty.`]">
        </div>

        <h2 class="s-header">{$config.confirmation.thankyou_header|default:"[`Заказ оформлен. Спасибо!`]"|escape}</h2>

        {if !empty($config.confirmation.thankyou_content)}
            <div class="s-description">{$config.confirmation.thankyou_content|replace:'$order_id':$_order_id|escape}</div>
        {/if}

        {if !empty($payment)}
            <div class="s-plugin-wrapper">{$payment}</div>
        {/if}

        {if !empty($payment_success)}
            <div class="s-payment-success highlighted">[`Your payment has been successfully accepted. We will process your order and contact you shortly.`]</div>
        {/if}

        <p class="s-actions-wrapper">
            <a href="{$wa_app_url}">[`Go to home page`]</a>
        </p>

        {if !empty($frontend_checkout)}
            {* @event frontend_checkout.%plugin_id% *}
            {foreach $frontend_checkout as $_}{$_}{/foreach}
        {/if}
    </div>

{*EMPTY*}
{elseif empty($_cart_count)}
    <div class="s-cart-empty-wrapper">
        <div class="s-image-wrapper">
            <img src="{$wa_theme_url}img/svg/order/cart_empty.svg" alt="[`Your shopping cart is empty.`]">
        </div>
        <p class="s-description">{$config.cart.empty_text|default:"[`Your shopping cart is empty.`]"|escape}</p>
        <p class="s-actions-wrapper">
            <a href="{$wa_app_url}">[`Go to home page`]</a>
        </p>
    </div>

{*ORDER*}
{else}
    <link rel="stylesheet" href="{$wa_theme_url}css/order.css?v={$wa_theme_version}">

    <div class="s-order-page" id="js-order-page">
        {if !empty($_show_cart)}
            <div class="s-order-column">

                <section class="s-order-section" id="js-order-cart">
                    <div class="s-section-header wa-flex-box full-line middle">
                        <h2 class="s-header">{$config.cart.block_name|default:"[`Корзина`]"|escape}</h2>
                        <a class="s-delete-button js-clear-cart" href="javascript:void(0);">
                            {$_svg_icon = '<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9.9 9.9"><path d="M0,8.5l3.5-3.5L0,1.4L1.4,0l3.5,3.5L8.5,0l1.4,1.4L6.4,4.9l3.5,3.5L8.5,9.9L4.9,6.4L1.4,9.9L0,8.5z"/></svg>'}
                            <span class="s-delete-icon">{$_svg_icon}</span>Удалить все товары
                        </a>
                    </div>
                    <div class="s-section-body">
                        {$wa->shop->checkout()->cart([
                            "DEBUG" => true,
                            "wrapper" => "#js-order-cart",
                            "some_other_options" => "whatever"
                        ])}
                    </div>
                </section>

            </div>
        {/if}

        <div class="s-order-column">

            <section class="s-order-section" id="js-order-form">
                <div class="s-section-header">
                    <h2 class="s-header">{$config.order.block_name|default:"[`Оформление`]"|escape}</h2>
                </div>
                <div class="s-section-body">
                    {$wa->shop->checkout()->form([
                        "DEBUG" => true,
                        "wrapper" => "#js-order-form",
                        "some_other_options" => "whatever"
                    ])}
                </div>
            </section>

        </div>

        <script>
            ( function($) {

                ( typeof window.ShopOrderPage === "function" ? init() : load().then(init) );

                function load() {
                    var deferred = $.Deferred();

                    $.getScript("{$wa_theme_url}js/order.js?v={$wa->version()}", function() {
                        deferred.resolve();
                    });

                    return deferred.promise();
                }

                function init() {
                    new window.ShopOrderPage({
                        $wrapper: $("#js-order-page"),
                        urls: {
                            "checkbox-icon": "{$wa_app_static_url}img/frontend/order/svg/sprite.svg#checkbox-yes"
                        }
                    });
                }

            })(jQuery);
        </script>
    </div>
{/if}